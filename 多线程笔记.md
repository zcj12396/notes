# 内存模型

C 	   ------      写缓冲器

 P		   ------      无效化队列

U			-----------------------------------------------     高速缓存     -------------------------   主存



#### 缓存一致性协议(MESI)中对单个数据的标记

###### MESI状态

+ Invalid (无效的，记为 I ) 表示对应缓存行不包含任何内存地址对应的有效副本。同时缓存的初始状态也是 I
+ Shared （共享的，记为S） 表示这个值为可能多个处理器所共有但都为 S
+ Exclusive （独占的，记为 E） 表示这个值是以独占的方式保留了数据，此时其他处理器上都不应该保留此数据的副本。处于这个状态时，其缓存行中的数据与主存中的数据一致。
+ Modified (更改过的，记为M) 表示此缓存行对应的内存地址所做的更新结果数据。同一时刻只能有一个处理器对某一数据持有M标记，处于该状态的缓存条目，其中包含的数据与主内存包含的数据不一致。

###### MESI消息

| 消息名          | 消息类型 | 描述                                                         |
| --------------- | :------: | ------------------------------------------------------------ |
| Read            |   请求   | 通知其他处理器、主存自己期望读取某个数据。 消息内包含待读取数据的内存地址 |
| Read-Response   |   响应   | 该消息包含被请求的数据 （可能是内存或其他处理器提供）        |
| Invalidate      |   请求   | 通知其他处理器把缓存中指定地址的缓存条目置为I （即删除)      |
| Invalidate- ACK |   响应   | 已删除的响应                                                 |
| Read Invalidate |   请求   | 由Read和Invalidate组成的复合消息，                           |
|                 |          |                                                              |



